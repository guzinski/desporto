{% extends "DesportoBundle::layout.html.twig" %}
{% form_theme form 'DesportoBundle:Form:fields.html.twig' %}
{% block title %}Desporto | Cadastro de Campeonato{% endblock %}
{% block head %}
    <link href="{{ asset('bundles/desporto/css/dropzone.css') }}" rel="stylesheet" />
    <script src="{{ asset('bundles/desporto/js/jquery.validate.min.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/messages_ptbr.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/validate/additional-methods.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/jquery.maskedinput.min.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/jquery.maskMoney.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/jquery-ui-1.10.3.min.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/dropzone.min.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/bootbox.min.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/bootstrap-wizard.min.js') }}"></script>
    <script src="{{ asset('bundles/desporto/js/select2.min.js') }}"></script>
    <script type="text/javascript" >
    jQuery(document).ready(function(){
        //Select
        jQuery("select").select2({
            minimumResultsForSearch: -1
        });
        jQuery('.select2-container').removeClass("form-control").css("width", "100%")
        
        //Inputs numéricos
        jQuery("input[type='number']").keyup(function(){
            var valor = jQuery(this).val();
            jQuery(this).val(valor.replace(/[^\d]/gi, ""));
        }).spinner({ min:1 });

        //Regras de campeonatos com chaves
        jQuery("#edicao_campeonato_quantidadeChaves, #edicao_campeonato_quantidadeClassificadosChave").parent().parent().hide();

        jQuery("#edicao_campeonato_tipo").change(function(){
            if (jQuery(this).val()=="C") {
                jQuery("#edicao_campeonato_quantidadeChaves, #edicao_campeonato_quantidadeClassificadosChave").parent().parent().show();
            } else {
                jQuery("#edicao_campeonato_quantidadeChaves, #edicao_campeonato_quantidadeClassificadosChave").parent().parent().hide();
            }
        });

        jQuery("#progressWizard").validate({
            rules: {
                'edicao_campeonato[quantidadeEquipes]' : {min: 4, max: 64, digits: true},
                'edicao_campeonato[quantidadeMinimaJogadores]' : {min: 5, max: function() {return jQuery('#edicao_campeonato_quantidadeMaximaJogadores').val() ==  "" ? 32 : jQuery('#edicao_campeonato_quantidadeMaximaJogadores').val() }, digits: true},
                'edicao_campeonato[quantidadeMaximaJogadores]' : {min: function() {jQuery('#edicao_campeonato_quantidadeMinimaJogadores').val() ==  "" ? 5 : jQuery('#edicao_campeonato_quantidadeMinimaJogadores').val()}, max: 32, digits: true},
            },
            highlight: function(element) {
                jQuery(element).closest('.form-group').removeClass('has-success').addClass('has-error');
            },
            success: function(element) {
                jQuery(element).closest('.form-group').removeClass('has-error');
            },
            errorPlacement: function(error, element) {
                jQuery(element).closest('.form-group').append(error);
            },
            validClass: "",
            submitHandler: function(form) {
                jQuery('button').hide();
                jQuery('#loading').fadeIn(200);
                form.submit();
           }
        });



        jQuery('#progressWizard').bootstrapWizard({
            onNext: function(tab, navigation, index) {
                if (!jQuery("#progressWizard").valid()) {
                    return false;
                }
            },
            onTabShow: function(tab, navigation, index) {
                tab.prevAll().addClass('done');
                tab.nextAll().removeClass('done');
                tab.removeClass('done');
                var $total = navigation.find('li').length;
                var $current = index + 1;
                
                if($current >= $total) {
                    $('#progressWizard').find('.wizard .next').addClass('hide');
                    $('#progressWizard').find('.wizard .finish').removeClass('hide');
                } else {
                    $('#progressWizard').find('.wizard .next').removeClass('hide');
                    $('#progressWizard').find('.wizard .finish').addClass('hide');
                }
                var $percent = ($current/$total) * 100;
                $('#progressWizard').find('.progress-bar').css('width', $percent+'%');
                
                
                if (index === 1) {
                    
                    
                    
                    
                    
                }
                
                
                
                
            }
        });
        

        
        
        
    })

        
    </script>
{% endblock %}

{% block mainpanel %}
<div class="pageheader">
    <div class="media">
        <div class="pageicon pull-left">
            <i class="fa fa-pencil"></i>
        </div>
        <div class="media-body">
            <ul class="breadcrumb">
                <li><a href="{{ path('index') }}"><i class="glyphicon glyphicon-home"></i></a></li>
                <li><a href="{{ path('equipe_index') }}">Campeonato</a></li>
                <li> Novo Campeonato </li>
            </ul>
            <h4> Novo Campeonato </h4>
        </div>
    </div><!-- media -->
</div><!-- pageheader -->

<div class="contentpanel">
    <div class="row">
        <div class="col-md-12">
            <h5 class="lg-title">Dados do Campeonato</h5>
            <p class="mb20">Informe os dados da edição do campeonato.</p>

            <!-- PROGRESS WIZARD -->
            <form method="post" action="teste" id="progressWizard" class="panel-wizard">
                <ul class="nav nav-justified nav-wizard">
                    <li><a href="#tab1-2" data-toggle="tab"><strong>Passo 1:</strong> Informações da competição</a></li>
                    <li><a href="#tab2-2" data-toggle="tab"><strong>Passo 2:</strong> Seleção das equipes</a></li>
                    <li><a href="#tab3-2" data-toggle="tab"><strong>Passo 3:</strong> Sorteio das chaves</a></li>
                </ul>

                <div class="progress progress-xs">
                    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100"></div>
                </div>

                <div class="tab-content">

                    <div class="tab-pane" id="tab1-2">
                        
                        <div class="row">
                            {{ form_row(form.campeonato) }}
                            {{ form_row(form.modalidade) }}
                            {{ form_row(form.tipo) }}
                            {{ form_row(form.quantidadeEquipes) }}
                            {{ form_row(form.quantidadeMinimaJogadores) }}
                            {{ form_row(form.quantidadeMaximaJogadores) }}
                            {{ form_row(form.quantidadeChaves) }}
                            {{ form_row(form.quantidadeClassificadosChave) }}
                            
                            {{ form_row(form.desempate1) }}
                            {{ form_row(form.desempate2) }}
                            {{ form_row(form.desempate3) }}
                        </div>

                    </div><!-- tab-pane -->

                    <div class="tab-pane" id="tab2-2">
                        
                        <div class="form-group  ">
                            <label class="col-sm-4 col-md-3 col-lg-2 control-label">
                                Equipe
                            </label>
                            <div class="col-sm-8 col-md-9 col-lg-5">
                                <input type="text" class="form-control" />
                            </div>

                        </div>                        
                    </div><!-- tab-pane -->

                    <div class="tab-pane" id="tab3-2">
                        <div class="form-group">
                            <label class="col-sm-4">Card No</label>
                            <div class="col-sm-8">
                                <input type="text" name="cardno" class="form-control" />
                            </div>
                        </div><!-- form-group -->

                        <div class="form-group">
                            <label class="col-sm-4">Expiration</label>
                            <div class="col-sm-4">
                                <select class="width100p" data-placeholder="Month">
                                    <option value="">Choose One</option>
                                    <option value="">January</option>
                                    <option value="">February</option>
                                    <option value="">March</option>
                                    <option value="">...</option>
                                </select>
                            </div>
                            <div class="col-sm-4">
                                <select class="width100p" data-placeholder="Year">
                                    <option value="">Choose One</option>
                                    <option value="">2013</option>
                                    <option value="">2014</option>
                                    <option value="">2015</option>
                                    <option value="">...</option>
                                </select>
                            </div>
                        </div><!-- form-group -->

                        <div class="form-group">
                            <label class="col-sm-4">CSV</label>
                            <div class="col-sm-4">
                                <input type="text" name="csv" class="form-control" />
                            </div>
                        </div><!-- form-group -->
                    </div><!-- tab-pane -->
                </div><!-- tab-content -->

                <ul class="list-unstyled wizard">
                    <li class="pull-left previous"><button type="button" class="btn btn-default">Voltar</button></li>
                    <li class="pull-right next"><button type="button" class="btn btn-primary">Próximo</button></li>
                    <li class="pull-right finish hide"><button type="submit" class="btn btn-primary">salvar</button></li>
                </ul>

            </form><!-- panel-wizard -->
            
        </div><!-- col-md-12 -->
    </div><!-- row -->
</div><!-- contentpanel -->
{% endblock %}